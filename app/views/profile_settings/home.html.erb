<!-- app/views/profile_settings/home.html.erb -->

<% content_for :sidebar do %>
  <%= render "profile_settings/sidebar" %>
<% end %>

<h1 class="text-xl font-bold mb-4">プロフィール設定ホーム</h1>

<% if @profile %>
  <p class="text-sm text-gray-600 mb-4">
    現在のプロフィールの概要です。
  </p>

  <dl class="text-sm space-y-3">
    <div>
      <dt class="text-gray-500">プロフィール名</dt>
      <dd class="font-semibold"><%= @profile.label %></dd>
    </div>

    <div>
      <dt class="text-gray-500">テーマカラー</dt>
      <dd><%= @profile.theme.presence || "未設定" %></dd>
    </div>
  </dl>

  <% if @incoming_team_invites.any? %>
    <div class="mt-6 border-t pt-4">
      <h2 class="text-sm font-semibold mb-2">このプロフィール宛のチーム招待</h2>

      <table class="w-full text-xs">
        <thead>
          <tr class="border-b">
            <th class="text-left py-1">チーム名</th>
            <th class="text-left py-1">招待元プロフィール</th>
            <th class="text-left py-1"></th>
          </tr>
        </thead>
        <tbody>
          <% @incoming_team_invites.each do |req| %>
            <tr class="border-b">
              <td class="py-1"><%= req.team.name %></td>
              <td class="py-1"><%= req.requester_profile&.display_name || "不明" %></td>
              <td class="py-1 text-right">
                <%= button_to "承認",
                              approve_membership_request_path(req),
                              method: :patch,
                              class: "px-3 py-1 text-[11px] bg-blue-100 text-blue-700 rounded border border-blue-300 hover:bg-blue-200" %>
              </td>
            </tr>
          <% end %>
        </tbody>
      </table>
    </div>
  <% else %>
    <p class="text-xs text-gray-500 mt-4">
      このプロフィール宛のチーム招待はありません。
    </p>
  <% end %>

<% else %>
  <p class="text-sm text-red-600">
    現在のプロフィールが選択されていません。
  </p>
<% end %>
